<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<!--AJAX is trying to call over HTTP where there server is running over HTTPS-->
	<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
	<link rel="shortcut icon" href="">
	<title> CS 290 Activity 5 </title>
    <script>
	 <!-- GET REQUEST-->
      document.addEventListener('DOMContentLoaded', bindButtons);

      function bindButtons()
	  {
		  	<!--object that can make an HTTP request and return the data it gets from that request.-->
	  	    var req = new XMLHttpRequest();
		    document.getElementById('urlSubmit').addEventListener('click', function(event){
		    console.log("1");
		    var city=document.getElementById('CITY_NAME').value;
			console.log(city);
		    var zip=document.getElementById('ZIP_CODE').value;
		    var country=document.getElementById('COUNTRY_CODE').value;
            var apiID='&appid=5254bba1382a3407c2af112214612a51';
			var rootURL='http://api.openweathermap.org/data/2.5/weather?q=';
			var comma =',';
			var getURL;
			
			console.log("2");
            console.log("3");
			
			<!--if zipcode and city is missing-->
			if (zip == null && city==null)
			{
			  return;
			}
			<!--search by zip, country-->
			else if (city == null)
			{
			  getURL=rootURL + zip + comma + country + apiID;
			}
			else
			{
			  getURL=rootURL + city + comma + country + apiID;
			}
            
			console.log(getURL);
		    <!--false means synchronous request, true=asynchronous-->
            req.open("GET", getURL, true);
			console.log("4");
            req.send(null);
		    <!--response=data retrieved from the request-->
			if (req.status >=200 && req.status <400)
			{
			  console.log("5");
		      console.log(JSON.parse(req.responseText));
			}
			else
			{
			  console.log("Error in Network!");
			  console.log("Error: " + req.status);
			}
			<!-- -->
            event.preventDefault();
		  })
      }
	
    </script>
	 
  </head>
  <body>
    <form>
      <fieldset>
        <legend>Weather Input (GET) </legend>
        <label for="CITY_NAME"> City: </label>
        <input type="text" name="CITY_NAME" id="CITY_NAME">
		<label for="ZIP_CODE"> Zipcode: </label>
        <input type="text" name="ZIP_CODE" id="ZIP_CODE">
		<label for="COUNTRY_CODE"> Country: </label>
        <input type="text" name="COUNTRY_CODE" id="COUNTRY_CODE" required>
        <input type="submit" id="urlSubmit">
      </fieldset>
    </form>
    <div>
      <h2>Result</h2>
      <ul>
        <li><span>Current Weather:</span><span id="weather"></span></li>
    
      </ul>
    </div>
  </body>
</html>